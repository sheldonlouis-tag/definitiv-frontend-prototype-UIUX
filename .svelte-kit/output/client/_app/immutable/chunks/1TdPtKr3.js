import"./DsnmJJEf.js";import{D as l,k as n,y as m,ai as q,p as k,c as w,f as x,a as g,b as M,q as z,s as B,n as j,t as E}from"./Be_f48sb.js";import{p as c,r as P,c as F,s as G}from"./DGH7gkaV.js";import{a as H,c as J}from"./9iBd7ymg.js";import{s as I}from"./DENQibGw.js";import{i as K}from"./Jn131pyZ.js";import{a as C,c as N,w as Q,d as U,e as p,m as V}from"./D5pQJlvA.js";import{C as W,D as X}from"./BHt2la1_.js";const b=N({component:"avatar",parts:["root","image","fallback"]}),_=new W("Avatar.Root");class A{static create(t){return _.set(new A(t))}opts;domContext;attachment;constructor(t){this.opts=t,this.domContext=new X(this.opts.ref),this.loadImage=this.loadImage.bind(this),this.attachment=C(this.opts.ref)}loadImage(t,r,a){if(this.opts.loadingStatus.current==="loaded")return;let e;const o=new Image;return o.src=t,r!==void 0&&(o.crossOrigin=r),a&&(o.referrerPolicy=a),this.opts.loadingStatus.current="loading",o.onload=()=>{e=this.domContext.setTimeout(()=>{this.opts.loadingStatus.current="loaded"},this.opts.delayMs.current)},o.onerror=()=>{this.opts.loadingStatus.current="error"},()=>{e&&this.domContext.clearTimeout(e)}}#t=l(()=>({id:this.opts.id.current,[b.root]:"","data-status":this.opts.loadingStatus.current,...this.attachment}));get props(){return n(this.#t)}set props(t){m(this.#t,t)}}class O{static create(t){return new O(t,_.get())}opts;root;attachment;constructor(t,r){this.opts=t,this.root=r,this.attachment=C(this.opts.ref),Q.pre([()=>this.opts.src.current,()=>this.opts.crossOrigin.current],([a,e])=>{if(!a){this.root.opts.loadingStatus.current="error";return}this.root.loadImage(a,e,this.opts.referrerPolicy.current)})}#t=l(()=>({id:this.opts.id.current,style:{display:this.root.opts.loadingStatus.current==="loaded"?"block":"none"},"data-status":this.root.opts.loadingStatus.current,[b.image]:"",src:this.opts.src.current,crossorigin:this.opts.crossOrigin.current,referrerpolicy:this.opts.referrerPolicy.current,...this.attachment}));get props(){return n(this.#t)}set props(t){m(this.#t,t)}}class D{static create(t){return new D(t,_.get())}opts;root;attachment;constructor(t,r){this.opts=t,this.root=r,this.attachment=C(this.opts.ref)}#t=l(()=>this.root.opts.loadingStatus.current==="loaded"?{display:"none"}:void 0);get style(){return n(this.#t)}set style(t){m(this.#t,t)}#s=l(()=>({style:this.style,"data-status":this.root.opts.loadingStatus.current,[b.fallback]:"",...this.attachment}));get props(){return n(this.#s)}set props(t){m(this.#s,t)}}var Y=z("<div><!></div>");function Z(f,t){const r=q();k(t,!0);let a=c(t,"delayMs",3,0),e=c(t,"loadingStatus",15,"loading"),o=c(t,"id",19,()=>U(r)),h=c(t,"ref",15,null),v=P(t,["$$slots","$$events","$$legacy","delayMs","loadingStatus","onLoadingStatusChange","child","children","id","ref"]);const S=A.create({delayMs:p.with(()=>a()),loadingStatus:p.with(()=>e(),s=>{e()!==s&&(e(s),t.onLoadingStatusChange?.(s))}),id:p.with(()=>o()),ref:p.with(()=>h(),s=>h(s))}),u=l(()=>V(v,S.props));var d=w(),R=x(d);{var T=s=>{var i=w(),y=x(i);I(y,()=>t.child,()=>({props:n(u)})),g(s,i)},L=s=>{var i=Y();H(i,()=>({...n(u)}));var y=B(i);I(y,()=>t.children??j),E(i),g(s,i)};K(R,s=>{t.child?s(T):s(L,!1)})}g(f,d),M()}function nt(f,t){k(t,!0);let r=c(t,"ref",15,null),a=c(t,"loadingStatus",15,"loading"),e=P(t,["$$slots","$$events","$$legacy","ref","loadingStatus","class"]);var o=w(),h=x(o);{let v=l(()=>J("relative flex size-8 shrink-0 overflow-hidden rounded-full",t.class));F(h,()=>Z,(S,u)=>{u(S,G({"data-slot":"avatar",get class(){return n(v)}},()=>e,{get ref(){return r()},set ref(d){r(d)},get loadingStatus(){return a()},set loadingStatus(d){a(d)}}))})}g(f,o),M()}export{nt as A,O as a,D as b};
